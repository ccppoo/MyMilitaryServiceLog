# 람다와 클로저 (진짜) 정리

* 서문

* 람다는 어디에서 왔는가?

* 람다식은 어떻게 구성되어 있는가?

* 열린 람다식, 닫힌 람다식

* 그래서 람다랑 클로저의 차이가 뭐야?

## 서문
 
정리를 하게된 이유는 Swift의 클로저(closure)가 내가 알고 있던 람다(lambda)식과 같다는 것을 알게 된 순간부터였다.

클로저와 람다식의 차이를 정확히 구분하지 않고, 언어를 접했을 때 '익명 함수를 그저 다른 방식으로 부르는 구나'라고 생각했다.

하지만, 파이썬에서 람다와 클로저가 다른 방식으로 쓰이는 것을 인지한 상태에서 스위프트는 람다식을 클로저라고 하니

분명히 언어가 쓰이는 데에 있어 명확히 알아야 할 필요를 느껴 stackoverflow의 좋은 답변글을 이해할 겸 번역을 하고,

이 글에서 그림과 함께 정리를 하고자 한다.

시작!

## 람다는 어디에서 왔는가?

람다(식)은 람다 대수(Lambda Calculus)으로부터 나왔다.

여기서는 수학적 의미로써의 람다를 논하지 않을 것이므로 더 깊고 파고 싶다면 직접 검색해보길 바란다.

람다식은 그리스 문자 람다(λ)가 식(expression) 앞에 있어 부르게 되었다.

우선 람다식은 어떻게 구성되어 있는지(1), 그리고 프로그래밍에 있어 어떤 의미를 갖는지(2) 알아보자

## 람다식은 어떻게 구성되어 있는가

간단하게 주어진 **변수**에 1을 더하는 람다식을 보자

```
λx.x+1
```

입력을 받는 변수(심볼) x는 아직 값을 받지 않은 상태이다.

외부로부터 값을 입력을 받을 문자 x 옆에 점('.') 옆에 식('x+1')으로 구성되어 있다.

```
λ<변수>.<표현식>
```

위와 같이 일반화 할 수 있다.

람다식 'λx.x+1'은 x의 값을 받으면 미지수가 없기 때문에 표현식을 평가(evaluate)할 수 있게된다.

조금 더 익숙한 코드 표현은 다음과 같다

```python
lambda x : x + 1
```

```Javascript
x => x + 1
```

파이썬 같은 경우 람다(lambda)를 직접 명시하는 반면, 자바스크립트는 람다 없이 선언을 할 수 있다.

이제 대략 왜 이게 "람다식" 또는 "람다 함수"라고 불리게 되었는지 감이 오는가?

```
일반적인 함수 :  f(x) = x + 1
람다식 (함수) : λx.x+1
```

보편적으로 알고 있던 함수의 모양은 위와 같다.

똑같이 하나의 변수(미지수) x를 받고 'x+1'을 반환하는 'f'라는 이름을 가진 함수다. 

즉 람다 함수는 일반적인 함수와 달리 이름이 존재하지 않는다.

정리하자면 람다식은 : 

* 1.이름이 없다.

* 2.주어진 변수(미지수)의 값만 넣으면 실행이 가능하다

## 열린 람다식, 닫힌 람다식

```
λx.x+y+1
```

조금 비틀어서 위와 같이 처음보는 y 가 있다고 치자.

람다식 자체가 틀리진 않았다. 단지 람다식을 평가했을 때

```
>>> (λx.x+y+1) 1

y + 2
```

그 결과는 숫자가 아닌 "미정"이다.

변수(미지수 : y)에 대한 정보가 없어 평가를 할 수 없는 상태다. 

이처럼 표현식(expression ; x + y + 1) 내에 **필요한 미지수의 모든 정보가 없어 평가가 불가능한 상태**의 람다를

**열린(Opened)** 람다라고 부른다.

반대로 람다식 'λx.x+1'은 **필요한 모든 미지수에 대한 정보를 제공 받아 평가가 가능한 상태**의 람다를 

**닫힌(Closed)** 람다라고 부른다.

*λx.x+1와 같이 x에 대한 확정적인 정보가 모두 주어진 x의 상태를 바인딩(bind)되었다고 부른다.*

정리 :

* 1. 람다 표현식에 존재하는 모든 심볼의 정보가 주어지면(확정) 이를 닫힌(Closed) 람다식이라고 한다.

* 2. 반대로 모든 심볼의 정보가 주어지지 않으면 이를 열린(Opened) 람다식이라고 한다.

## 프로그래밍스럽게 이해해보기

닫힌 람다식 '(λx.x + 1) 1'에서 주어진 정보는 다음과 같다.

{ 'x' : 1 }

열린 람다식 '(λx.x + y + 1) 1'에서 주어진 정보는 다음과 같다.

{ 'x' : 1, 'y' : undefined }

열린 람다식을 마저 평가(evaluate)하기 위해서 필요한 정보는 y다. 

열린 람다식을 닫게(close) 만들어 평가를 하기 위한 딕셔너리는 다음 중 무엇일까?

```javascript
_1 : { 'y' : 2 }
_2 : { 'x' : 3, 'y' : 5 }
_3 : { 'a' : 4, 'x' : 10 }
_4 : { 'jsonLoad' : { 'res' : 200, 'content-type' : 'text/plain' } , y : 33 }
```

...

1,2,4 가 정답이다. 

열린 람다식을 확정짓는, 즉 닫는, 필수적인 정보를 담고만 있으면 된다.

위 같이 열린 람다식을 닫게 만들어 연산이 가능하도록 만들어주는 정보자체를 클로저(closure)라고 한다.

> 열린 람다식을 닫게 만드는 자 : close + er -> closure 

라고 이해하면 될 것이다.

1,2,4가 클로저(closure)다!

## 그래서 람다랑 클로저의 차이가 뭐야?

람다와 클로저는 대조 할 수 있는 관계가 아니다. 

'열린 람다'를 '닫힌 람다'로 만들어 주는 것이 '클로저(closure)'다.

열린 람다 + 클로저 == 닫힌 람다 == 이름 없는 함수 (상수와 같은 '값'을 반환하는)
